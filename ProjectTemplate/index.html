<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Company Feedback System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #fff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .login-container,
        .contentPanel {
            width: 100%;
            max-width: 330px;
            margin: auto; /* This will center the div if the outer container is a flex container */
            display: none; /* Start with all panels hidden */
            flex-direction: column; /* Stack children vertically */
            padding: 15px;
            border: 1px solid #C1BFBF;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            background-color: #fff;
        }

            .contentPanel button,
            .login-container button {
                width: calc(100% - 20px);
                padding: 10px;
                border: none;
                border-radius: 3px;
                background-color: #8C1D40; /* ASU Maroon */
                color: #FFC627; /* ASU Gold */
                font-size: 16px;
                cursor: pointer;
                transition: background-color 0.3s;
                margin-top: 10px; /* Space between buttons */
            }

                /* Button hover effect */
                .contentPanel button:hover,
                .login-container button:hover {
                    background-color: #991F3D; /* A darker shade of ASU Maroon */
                }

            .login-container h2,
            .contentPanel h2 {
                color: #8C1D40; /* ASU Maroon */
                text-align: center;
                margin-bottom: 20px;
            }

        .form-group {
            margin-bottom: 15px;
        }

            .form-group label {
                display: block;
                margin-bottom: 5px;
                color: #5C6670; /* ASU Gray */
            }

            .form-group input {
                width: calc(100% - 20px);
                padding: 10px;
                margin-bottom: 10px;
                border: 1px solid #8C1D40; /* ASU Maroon */
                border-radius: 3px;
            }

        .hidden {
            display: none;
        }

        /* No space above the first button */
        .login-container button:first-of-type,
        .contentPanel button:first-of-type {
            margin-top: 0;
        }

        /* Add space below the last button */
        .login-container button:last-of-type,
        .contentPanel button:last-of-type {
            margin-bottom: 10px;
        }

        /* If I need to adjust the space around the button */
        .login-container button:not(:last-of-type),
        .contentPanel button:not(:last-of-type) {
            margin-bottom: 10px;
        }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>

    <!-- Login Section -->
    <div id="loginSection" class="login-container contentPanel">
        <h2>Login</h2>
        <form id="loginForm">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required placeholder="Enter your username">
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required placeholder="Enter your password">
            </div>
            <button type="button" onclick="loginHandler()">Sign In</button>
            <br />
            <button onclick="javascript: lazyloginHandler('supervisor');">Login as Supervisor</button>
            <button onclick="javascript: lazyloginHandler('employee');">Login as Employee</button>
        </form>
    </div>

    <!-- Supervisor Section -->
    <div id="SupervisorHome" class="contentPanel">
        <h2>Supervisor Dashboard</h2>
        <!-- Supervisor-specific content goes here -->
        <button onclick="javascript: QuestionListHandler();">Click here to see the list of questions I have posted</button>
        <button onclick="javascript: showPanel('SubmitQuestion')">Click here to submit a question</button>
        <button onclick="javascript: logoffHandler();">Log Off</button>
    </div>

    <!-- Employee Section -->
    <div id="EmployeeHome" class="contentPanel">
        <h2>Employee Dashboard</h2>
        <!-- Employee-specific content goes here -->
        <button onclick="javascript: QuestionListHandler();">Click here to see the list of questions I can answer</button>
        <button onclick="javascript: showPanel('unsolicitedFeedback')">Click here to submit feedback</button>
        <button onclick="javascript: logoffHandler();">Log Off</button>
    </div>

    <div id="QuestionList" class="contentPanel">
        <div class="left">Question List</div>
        <div>
            This should be a list of questions available for the logged-in user to answer.<br />
            If the logged-in user is a supervisor, it should be a list of questions they have posted.<br />
            Note: does not currently check if the user has answered the question already.<br />
        </div>
        <div id="questionListDisplay">
            List should go here!
        </div>
        <button onclick="javascript: DashboardHandler();">Return to dashboard</button>
        <button onclick="javascript: logoffHandler();">Log Off</button>
    </div>

    <div id="AnswerList" class="contentPanel">
        <div class="left">Answer List</div>
        <div>
            Note: does not currently check if the answer is marked as reviewed.<br />
        </div>
        <div id="answerListDisplay">
            List should go here!
        </div>
        <button onclick="javascript: DashboardHandler();">Return to dashboard</button>
        <button onclick="javascript: logoffHandler();">Log Off</button>
    </div>

    <div id="SubmitQuestion" class="contentPanel">
        <form it="postQuestionForm" onsubmit="submitQuestionHandler(); return false;">
            <div class="left">Submit Question</div>
            <div>
                Character limit: questionText: 1000<br />
                This limit is enforced but the current character count and character limit are not displayed.
            </div>
            <div>
                <textarea id="questionText" rows="10" cols="50" maxlength="1000" placeholder="Enter question..." required></textarea>
            </div>
            <div>
                Days to live (enter 0 for no expiration): <input type="text" id="daysToLive" size="3" maxlength="3" placeholder="0" />
            </div>
            <div>
                <button type="submit">Save</button>
            </div>
            <hr />
        </form>
        <button onclick="javascript: DashboardHandler();">Cancel</button>
    </div>

    <div id="SubmitAnswer" class="contentPanel">
        <form it="postQuestionForm" onsubmit="submitAnswerHandler(); return false;">
            <div class="left">Submit Question</div>
            <div id="selectedQuestion">Question should be displayed here.</div>
            <div>
                Character limit: answerText: 1000<br />
                This limit is enforced but the current character count and character limit are not displayed.
            </div>
            <div>
                <textarea id="answerText" rows="10" cols="50" maxlength="1000" placeholder="Enter question..." required></textarea>
            </div>
            <div>
                <button type="submit">Save</button>
            </div>
            <hr />
        </form>
        <button onclick="javascript: DashboardHandler();">Cancel</button>
    </div>

    <div id="unsolicitedFeedback" class="contentPanel">
        <form id="unsolicitedFeedbackForm" onsubmit="UnsolicitedFeedbackHandler(); return false;">
            <div class="left">Submit Unsolicited Feedback</div>
            <div>
                Character limits: problemArea: 20, complaint: 50, proposedSolution: 1000<br />
                These limits are enforced but the current character counts and character limits are not displayed.
            </div>
            <div>
                Problem Area: <input type="text" id="problemArea" size="20" maxlength="20" required />
            </div>
            <div>
                Complaint: <input type="text" id="complaint" size="50" maxlength="50" required />
            </div>
            <div>
                <textarea id="proposedSolution" rows="10" cols="50" maxlength="1000" placeholder="Enter proposed solution..." required></textarea>
            </div>
            <div>
                <button type="submit">Save</button>
            </div>
            <hr />
        </form>
        <button onclick="javascript: DashboardHandler();">Return to dashboard</button>

    </div>

    <!--YOUR OWN JAVASCRIPT CAN GO RIGHT HERE-->
    <script type="text/javascript">

        //this function executes once jQuery has successfully loaded and is
        //ready for business.  Usually, if we're wiring up event handlers via jQuery
        //then this is where they go.
        jQuery(function () {
            //when the app loads, check to see if the user is logged in.  If so, show their dashboard.  If not, show the logon panel to start with!
            var webMethod = "ProjectServices.asmx/IsSupervisor";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === -1) {
                        showPanel('loginSection');
                    } else {
                        if (msg.d === 1) {
                            showPanel('SupervisorHome');
                        } else {
                            showPanel('EmployeeHome');
                        }
                    }
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        });

        // Function for showing a particular section
        function showSection(sectionId) {
            $('.container').hide(); // Hide all sections
            $('#' + sectionId).removeClass('hidden').show(); // Show the requested section
        }
        //we're using a stacked card approach for our main viewing area
        //this array holds the ids of our cards and the method
        //allows us to easly switch the interface from one to the other
        var contentPanels = ['loginSection', 'SupervisorHome', 'EmployeeHome', 'QuestionList', 'AnswerList', 'SubmitAnswer', 'unsolicitedFeedback', 'SubmitQuestion'];
        //this function toggles which panel is showing, and also clears data from all panels
        // Toggles which panel is showing, and also clears data from all panels
        function showPanel(panelId) {
            clearData();
            contentPanels.forEach(function (panel) {
                var element = document.getElementById(panel);
                if (panelId == panel) {
                    element.style.display = 'flex'; // Show the requested panel
                } else {
                    element.style.display = 'none'; // Hide other panels
                }
            });
        }


        //this function clears data from all panels
        function clearData() {
            $('#username').val("");
            $('#password').val("");
            $('#questionText').val("");
            $('#problemArea').val("");
            $('#complaint').val("");
            $('#proposedSolution').val("");
            $('#answerText').val("");
            $('#daysToLive').val("");
            // more will be added as more panels are added
        }

        function DashboardHandler() {
            //return the user to their dashboard
            var webMethod = "ProjectServices.asmx/IsSupervisor";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === -1) {
                        showPanel('loginSection');
                    } else {
                        if (msg.d === 1) {
                            showPanel('SupervisorHome');
                        } else {
                            showPanel('EmployeeHome');
                        }
                    }
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        // Login handler function
        function loginHandler() {
            var username = $('#username').val().trim();
            var password = $('#password').val().trim();

            if (username === '' || password === '') {
                alert('Please fill in both username and password.');
                return;
            }

            var webMethod = "ProjectServices.asmx/LogOn";
            var parameters = JSON.stringify({
                uid: username,
                pass: password
            });
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === 1) {
                        showPanel('SupervisorHome');
                    } else if (msg.d === 0) {
                        showPanel('EmployeeHome');
                    } else {
                        alert('Login failed: Incorrect username or password.');
                    }
                },
                error: function (e) {
                    alert("There was an issue with the login request.");
                }
            });
        }

        function logoffHandler() {
            var webMethod = "ProjectServices.asmx/LogOff";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    clearData();
                    showPanel('loginSection');
                },
                error: function (e) {
                    alert("There was an issue with the logoff request.");
                }
            });
        }
        // Placeholder for submitQuestionHandler function
        function submitQuestionHandler() {
            var webMethod = "ProjectServices.asmx/SubmitQuestion";
            var parameters = "{}";
            var parameters = "{\"questionText\":\"" + encodeURI($('#questionText').val()) + "\",\"daysToLive\":\"" + encodeURI($('#daysToLive').val()) + "\"}";
            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var responseFromServer = msg.d;
                    if (responseFromServer > 0) {
                        alert("Question submitted successfully");
                        showPanel('SupervisorHome');
                    }
                    else {
                        alert("Feedback submission failed");
                    }
                },

                error: function (e) {
                    alert("this code will only execute if javascript is unable to access the webservice");
                }
            });
        }

        // Placeholder for unsolicitedFeedbackHandler function
        function UnsolicitedFeedbackHandler() {
            var webMethod = "ProjectServices.asmx/UnsolicitedFeedback";
            var parameters = "{}";
            var parameters = "{\"problemArea\":\"" + encodeURI($('#problemArea').val()) + "\",\"complaint\":\"" + encodeURI($('#complaint').val()) + "\",\"proposedSolution\":\"" + encodeURI($('#proposedSolution').val()) + "\"}";

            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var responseFromServer = msg.d;
                    if (responseFromServer > 0) {
                        alert("Feedback submitted successfully");
                        showPanel('EmployeeHome');
                    }
                    else {
                        alert("Feedback submission failed");
                    }
                },
                error: function (e) {
                    alert("this code will only execute if javascript is unable to access the webservice");
                }
            });
        }

        // Add event listeners to forms
        $('#postQuestionForm').submit(function (e) {
            e.preventDefault(); // Prevent the default form submission
            submitQuestionHandler();
        });

        $('#unsolicitedFeedbackForm').submit(function (e) {
            e.preventDefault(); // Prevent the default form submission
            unsolicitedFeedbackHandler();
        });

        //this is to display questions available to be answered or reviewed
        function QuestionListHandler() {
            showPanel("QuestionList");
            var webMethod = "ProjectServices.asmx/IsSupervisor";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    issupervisor = msg.d;
                    var webMethod2 = "ProjectServices.asmx/GetQuestions";
                    $.ajax({
                        type: "POST",
                        url: webMethod2,
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (msg) {
                            if (msg.d.length > 0) {
                                $("#questionListDisplay").empty();
                                for (var i = 0; i < msg.d.length; i++) {
                                    if (issupervisor == 1) {
                                        question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>" +
                                            "<span class='questionText'>" + msg.d[i].question +
                                            "</span> <span class='optionsTag'><a href='#' onclick='AnswerListHandler(" + msg.d[i].id + ")'> review responses (not implemented)</a></div> <hr>";
                                    }
                                    else {
                                        question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>" +
                                            "<span class='questionText'>" + msg.d[i].question +
                                            "</span> <span class='optionsTag'><a href='#' onclick='AnswerHandler(" + msg.d[i].id + ")'>respond (not implemented)</a></div> <hr>";
                                    }
                                    $("#questionListDisplay").append(question);
                                }
                            }
                        },
                        error: function (e) {
                            alert("boo...2");
                        }
                    });
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //this is to display answers available to be reviewed
        function AnswerListHandler(questionID) {
            showPanel("AnswerList");
            var webMethod = "ProjectServices.asmx/GetAnswers";
            var parameters = "{\"questionID\":\"" + questionID + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        $("#answerListDisplay").empty();
                        for (var i = 0; i < msg.d.length; i++) {
                            answer = "<div class='answerRow' id='questR" + msg.d[i].id + "'>" +
                                "<span class='answerText'>" + msg.d[i].answer +
                                "</span> <span class='optionsTag'><a href='#' onclick='AnswerHandler(" + msg.d[i].id + ")'>mark as reviewed (not implemented)</a></div> <hr>";
                            $("#answerListDisplay").append(answer);
                        }
                    }
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        // NOTE THIS IS ONLY HERE BECAUSE I AM A LAZY DEVELOPER AND GOT TIRED OF TYPING IN CREDENTIALS
        // THIS WILL NEED TO BE DELETED BEFORE THE PROJECT IS SUBMITTED
        function lazyloginHandler(role) {
            var webMethod = "ProjectServices.asmx/Login";
            var parameters = "{\"role\":\"" + role + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === 1) {
                        showPanel('SupervisorHome')
                    } else if (msg.d === 0) {
                        showPanel('EmployeeHome')
                    } else {
                        alert('Login failed: Incorrect username or password.');
                    }
                },
                error: function (e) {
                    alert("boo...hiss");
                }
            });
        }

    </script>
</body>
</html>
















