<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Company Feedback System</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, #8C1D40, #a3555c, #b76e7a, #FFC627);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .titleContainer {
            position: fixed;
            top: 0;
            width: 100%;
            background: #8C1D40;
            color: #FFC627;
            padding: 10px 0;
            text-align: center;
            font-size: 24px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .menu a {
            color: #FFC627;
            text-decoration: none;
            padding: 5px 10px;
            display: inline-block;
        }

        .contentContainer {
            margin-top: 50px;
            width: 100%;
            max-width: 600px; /* Adjusted width for better layout */
            padding: 20px; /* Padding for spacing */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center; /* Center align items for consistent button alignment */
        }

        .login-container,
        .contentPanel {
            display: none; /* WAS display: flex - that flashed each div upon page load - now hides by default instead of flex by default */
            flex-direction: column;
            padding: 20px;
            border: 2px solid #FFC627; /* Thicker border with gold color */
            border-radius: 10px; /* Rounded corners for a modern look */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); /* Enhanced shadow for depth */
            background-color: #fff;
            margin-bottom: 20px;
            align-items: center; /* Center align items for consistent button alignment */
        }

            .login-container button,
            .contentPanel button {
                width: auto; /* Auto width for buttons */
                padding: 15px 30px; /* Larger padding for a better touch area */
                border: none;
                border-radius: 5px;
                background-color: #8C1D40;
                color: #FFC627;
                font-size: 18px; /* Larger font size for buttons */
                cursor: pointer;
                transition: transform 0.2s ease, box-shadow 0.2s ease; /* Smooth transition for interaction */
                margin-top: 20px;
                align-self: center; /* Center buttons in the flex container */
            }

                /* Button hover effect */
                .login-container button:hover,
                .contentPanel button:hover {
                    background-color: #991F3D;
                    transform: translateY(-3px); /* Slight lift effect on hover */
                    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); /* Shadow effect on hover */
                }

            .login-container h2,
            .contentPanel h2 {
                color: #8C1D40;
                text-align: center;
                margin-bottom: 20px;
                font-size: 28px; /* Larger font size for headers */
                font-weight: bold; /* Bold font weight for headers */
            }

        .form-group {
            margin-bottom: 20px;
            width: 100%; /* Ensure form elements fit container width */
        }

            .form-group label {
                display: block;
                margin-bottom: 10px;
                color: #5C6670;
                font-weight: bold; /* Bold labels for clarity */
            }

            /* Ensuring inputs and textareas fit their parent containers */
            .form-group input,
            .form-group textarea {
                width: 100%;
                padding: 15px;
                margin-bottom: 10px;
                border: 1px solid #C1BFBF;
                border-radius: 5px;
                box-sizing: border-box;
                font-size: 16px; /* Readable font size for inputs */
            }

        /* Ensures textareas do not overflow their parent container */
        .contentPanel textarea {
            resize: none; /* Allow only vertical resizing */
        }

        .hidden {
            display: none;
        }

        /* Additional styling for flair */
        /* Style the placeholders to match the theme */
        ::placeholder {
            color: #8C1D40;
            opacity: 0.7; /* Placeholder text slightly lighter than normal text */
        }

        /* Highlight input borders on focus to improve user experience */
        input:focus, textarea:focus {
            border-color: #8C1D40;
            box-shadow: 0 0 0 2px rgba(140, 29, 64, 0.2);
        }

        /* Custom styles for feedbackEntry */
        .feedbackEntry {
            border: 1px solid #FFC627;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 5px;
            background-color: #f7f7f7;
        }

            .feedbackEntry p {
                margin: 0 0 10px;
                color: #333;
                font-size: 16px;
            }

        /* Enhance visual hierarchy in question and answer lists */
        .questionRow, .answerRow {
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        .questionText, .answerText {
            color: #8C1D40;
            font-weight: bold;
        }

        .optionsTag a {
            color: #FFC627;
            text-decoration: underline;
            cursor: pointer;
        }

        /* Style for showing more questions - more prominent */
        #questMore {
            background-color: #FFC627;
            color: #8C1D40;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            margin-top: 20px;
        }

        /* Hover effect for links */
        .optionsTag a:hover {
            color: #991F3D;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .contentContainer {
                max-width: 95%;
                margin: 20px;
            }

            .login-container,
            .contentPanel {
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
            }
        }

        /* Activity List Styles */
        #ActivityList {
            background-color: #fff; /* White background for contrast */
            padding: 20px;
            border: 2px solid #FFC627; /* Border color to match existing style */
            border-radius: 10px; /* Rounded corners to match existing style */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); /* Shadow to match existing style */
            margin: 20px 0; /* Margin for spacing */
            width: auto; /* To ensure it does not stretch beyond the max-width of contentContainer */
        }

        #activityListDescription {
            color: #8C1D40; /* Maroon color for the text */
            font-size: 18px; /* Size to match similar elements */
            margin-bottom: 20px; /* Margin for spacing */
            text-align: center; /* Centering the text */
            font-weight: bold; /* Bold for emphasis */
        }

        #activityListTable {
            width: 100%; /* Full width */
            border-collapse: collapse; /* Collapse borders for a clean look */
            background-color: #fff; /* White background for the table */
        }

            #activityListTable th,
            #activityListTable td {
                padding: 10px;
                text-align: left; /* Align text to the left for readability */
                border: 1px solid #FFC627; /* Border color to match the theme */
            }

        #activityListHead {
            background-color: #8C1D40; /* Background color for header to match the theme */
            color: #FFC627; /* Text color for header to match the theme */
            font-size: 16px; /* Slightly smaller font size for the header */
        }

        .listRow:nth-child(odd) {
            background-color: #f7f7f7; /* Zebra striping for rows, light grey */
        }

        .listRow:nth-child(even) {
            background-color: #fff; /* White for contrast in zebra striping */
        }

        .listRow:hover {
            background-color: #FFC627; /* Hover effect with the theme's gold color */
            color: #8C1D40; /* Text color change on hover for better visibility */
        }

        /* Responsive styles for activity list */
        @media (max-width: 768px) {
            #ActivityList {
                width: 95%; /* Full width on smaller screens for better visibility */
                margin: 20px auto; /* Centering the box */
                overflow-x: auto; /* Allowing horizontal scrolling on small screens */
            }
        }

        /* Styles for radio buttons and their labels */
        .radio-group {
            color: #8C1D40; /* Text color for labels */
            font-weight: bold;
        }

            .radio-group input[type="radio"] {
                accent-color: #8C1D40; /* Color of the radio button */
            }

            .radio-group label {
                display: block;
                margin: 5px 0px;
                font-size: 16px;
                cursor: pointer;
            }

        /* Button styles to match theme */
        .button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #8C1D40;
            color: #FFC627;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 10px; /* Adjust as needed */
            align-self: center; /* Center the button if within a flex container */
        }

            .button:hover {
                background-color: #991F3D; /* Darker shade on hover */
            }

        /* Common styles for headers */
        .header-text {
            color: #8C1D40; /* Matching the theme's header color */
            font-size: 20px; /* Adjust the size as needed */
            font-weight: bold;
            margin-bottom: 20px; /* Spacing after the header */
            text-align: center; /* Center align the header */
        }

        /* Styling for the container of the form elements */
        .form-container {
            background-color: #fff; /* White background for the form container */
            padding: 20px; /* Padding inside the container */
            border-radius: 10px; /* Rounded corners for the form container */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
            margin: 20px 0; /* Spacing around the container */
        }

        /* Style for the multiple-choice dropdown in the Employee submit answer page */
        #answerText {
            background-color: #fff; /* White background for clarity */
            border: 2px solid #8C1D40; /* Thicker border with the theme's maroon color */
            border-radius: 8px; /* Rounded corners for a modern, friendly look */
            padding: 10px 15px; /* Adequate padding for a touch-friendly design */
            width: calc(100% - 30px); /* Full width minus padding */
            font-size: 16px; /* Comfortable reading size */
            color: #8C1D40; /* Text color matching the theme */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
            outline: none; /* Remove the default focus outline */
            margin-bottom: 20px; /* Space below the dropdown */
            cursor: pointer; /* Indicates the element is interactive */
        }
        
        input[type='number'] {
            background-color: #fff; /* White background for clarity */
            border: 2px solid #8C1D40; /* Thicker border with the theme's maroon color */
            border-radius: 8px; /* Rounded corners for a friendly look */
            padding: 10px; /* Adequate padding inside the input */
            width: 100%; /* Full width of its container */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
            font-size: 16px; /* Comfortable reading size */
            color: #8C1D40; /* Text color to match the theme */
            outline: none; /* Remove the default focus outline */
            text-align: center; /* Centers the text/number inside */
            -moz-appearance: textfield; /* Fixes appearance in Firefox */
        }

        /* Ensure that the number input is not too wide on desktop */
        @media (min-width: 768px) {
            input[type='number'] {
                max-width: 200px; /* Maximum width for the number input */
                margin: 0 auto; /* Centers the number input */
            }
        }

        /* Add focus styles for both dropdown and number input for accessibility */
        input[type='number']:focus {
            border-color: #FFC627; /* Highlight color when focused */
            box-shadow: 0 0 0 2px rgba(255, 198, 39, 0.5); /* Glow effect for focus */
        }

        /* Style for the question list container */
        #questionListDisplay {
            overflow-y: auto; /* Adds a scrollbar if content overflows vertically */
            max-height: calc(100vh - 300px); /* Adjusted height to account for header and buttons */
            width: 100%; /* Full width */
            padding: 15px; /* Padding inside the container */
            box-sizing: border-box; /* Includes padding in width calculation */
            margin-bottom: 20px; /* Space below the container before buttons */
        }

        /* Style for individual question entries */
        .questionRow {
            background-color: #fff; /* White background for contrast */
            border-bottom: 1px solid #ddd; /* Bottom border for each question */
            padding: 10px; /* Padding inside each question */
            margin-bottom: 10px; /* Space between questions */
        }

        /* Enhancements for question text */
        .questionText {
            color: #8C1D40; /* Text color to match the theme */
            font-weight: bold; /* Bold font for question text */
            display: block; /* Ensures full width */
            margin-bottom: 5px; /* Space below the question text */
        }

        /* Style adjustments for small screens */
        @media (max-width: 768px) {
            #questionListDisplay {
                max-height: calc(100vh - 210px); /* Adjusted max height for smaller screens */
            }
        }

        /* Ensuring the body does not scroll */
        body {
            overflow-x: hidden; /* No horizontal scrollbar for the body */
            overflow-y: hidden; /* No vertical scrollbar for the body */
        }

        /* Centers everything in the login container */
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

         /* Additional styles for buttons within the login container to ensure they take full width */
        .login-container button {
            width: 100%; /* Makes buttons full width */
            margin: 10px 0; /* Adds space between buttons */
        }

        /* Wraps buttons in a flex container to center them */
        .login-buttons-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        #button-container-id {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Additional CSS for centering Save buttons */
        .save-button {
            align-self: center; /* Center the button in a flex container */
            margin: 10px auto; /* Adds top and bottom margin, and auto left/right margins */
            display: block; /* Will ensure the button is a block-level element */
        }

        /*TESTING NEW CSS CODE*/

        /* Create Account & Edit Account Common Styles */
        #accountspanel, #editAccountPanel {
            display: none; /* Initial state set to not display */
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

            #accountspanel form,
            #editAccountPanel form {
                width: 100%;
                max-width: 600px; /* To match other forms */
                margin: 0 auto; /* Center the form in the panel */
            }

            /* Input fields styling */
            #accountspanel input[type='text'],
            #accountspanel input[type='password'],
            #editAccountPanel input[type='text'],
            #editAccountPanel input[type='password'] {
                width: 100%; /* Full width to match container */
                padding: 10px; /* Comfortable padding */
                margin-bottom: 10px; /* Space between form fields */
                border: 1px solid #C1BFBF; /* Consistent border */
                border-radius: 5px; /* Rounded corners */
                box-sizing: border-box; /* Include padding in width */
                font-size: 16px; /* Readable font size */
            }

            /* Button styling */
            #accountspanel button,
            #editAccountPanel button {
                width: auto; /* Auto width for buttons */
                padding: 10px 30px; /* Padding for a larger touch area */
                border: none;
                border-radius: 5px;
                background-color: #8C1D40; /* Consistent button color */
                color: #FFC627; /* Consistent text color */
                font-size: 16px; /* Readable font size */
                cursor: pointer; /* Indicates an action can be taken */
                transition: background-color 0.3s ease; /* Smooth transition for interaction */
                margin-top: 20px; /* Space above the button */
                align-self: center; /* Center the button */
            }

                #accountspanel button:hover,
                #editAccountPanel button:hover {
                    background-color: #991F3D; /* Darker shade on hover */
                }

            /* Header within the account panels */
            #accountspanel .left,
            #editAccountPanel .left {
                font-size: 24px; /* Header size */
                font-weight: bold; /* Bold for header */
                color: #8C1D40; /* Consistent text color */
                margin-bottom: 20px; /* Space below the header */
                text-align: center; /* Center the text */
            }

            /*TESTING NEW CSS STYLES*/
            .button {
                padding: 10px 15px;
                border: none;
                border-radius: 5px;
                background-color: #8C1D40; /* Adjust the color to match your theme */
                color: #FFC627; /* Adjust text color to match your theme */
                font-size: 16px;
                cursor: pointer;
                transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            }

            .button:hover {
                background-color: #991F3D; /* Darker shade on hover for visual feedback */
                transform: translateY(-3px); /* Moves the button up */
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); /* Adds shadow for depth */
            }

     </style>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>

    <!-- <div class="titleContainer">
         <div id="menu" class="menu">

             <a href="#" onclick="LogOff()">log off</a>
         </div>
     </div> -->
    <!--  <a href="#" onclick="LogOff()">log off</a> -->

    <div class="titleContainer">
        <div id="menu" class="menu">

            <a href="#" onclick="GoBack()">log off</a>
        </div>
    </div>
    <a href="#" onclick="GoBack()">log off</a>

    <div class="contentContainer">
        <!-- Login Section -->
        <div id="login-container" class="login-container contentPanel">
            <h2>Login</h2>
            <form id="loginForm" onsubmit="LogOn($('#userId').val(), $('#pass').val()); return false;">
                <div class="form-group">
                    <label for="userId">Username:</label>
                    <input type="text" id="userId" name="username" required placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="pass">Password:</label>
                    <input type="password" id="pass" name="password" required placeholder="Enter your password">
                </div>
                <button type="submit">Sign In</button>
                <button type="button" onclick="showPanel('resetPasswordPanel')">Reset Password</button>
                <br />
                <hr />
                <h2>Lazy Quick Developer Logins</h2>
                <button onclick="javascript: lazyloginHandler('supervisor');">Login as Supervisor</button>
                <button onclick="javascript: lazyloginHandler('employee');">Login as Employee</button>
                <button onclick="showPanel('accountspanel')">Create Account</button>
                <button onclick="showPanel('editAccountPanel')">Edit Account</button>
            </form>
        </div>


        <!-- The Reset Password form -->
        <div id="resetPasswordPanel" class="contentPanel hidden">
            <h2>Reset Password</h2>
            <form id="resetPasswordForm" onsubmit="resetPasswordHandler(); return false;">
                <div class="form-group">
                    <label for="resetUserId">Username:</label>
                    <input type="text" id="resetUserId" name="resetusername" required placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="oldPass">Old Password:</label>
                    <input type="password" id="oldPass" name="oldpassword" required placeholder="Enter your old password">
                </div>
                <div class="form-group">
                    <label for="newPass">New Password:</label>
                    <input type="password" id="newPass" name="newpassword" required placeholder="Enter your new password">
                </div>
                <button type="submit">Reset Password</button>
                <button type="button" onclick="showPanel('login-container')">Cancel</button>
            </form>
        </div>

        <!-- Supervisor Section -->
        <div id="SupervisorHome" class="contentPanel">
            <h2>Supervisor Dashboard</h2>
            <!-- Supervisor-specific content goes here -->
            <!-- <a href="#" onclick="LogOff()">log off</a> <!--add log off to only show in supervisor screen-->
            <button onclick="javascript: QuestionListHandler();">Review Questions I Have Posted</button>
            <button onclick="javascript: showPanel('SubmitQuestion')">Post A New Question</button>
            <button onclick="javascript: loadUnsolicitedFeedbackReview();">Review Unsolicited Feedback</button>
            <!--Added Configure Employee Questions button-->
            <!-- <button type="button" onclick="showResponseTypeConfig()" class="button">Configure Employee Questions</button> -->
            <button onclick="javascript: showPanel('activityReportQuery');">Generate Activity List</button>
            <button onclick="javascript: LogOff();">Log Off</button>
        </div>

        <!-- Employee Section -->
        <div id="EmployeeHome" class="contentPanel">
            <h2>Employee Dashboard</h2>
            <!-- Employee-specific content goes here -->
            <!-- <a href="#" onclick="LogOff()">log off</a> -->
            <button onclick="javascript: QuestionListHandler();">Answer Posted Questions</button>
            <button onclick="javascript: showPanel('unsolicitedFeedback')">Submit Feedback</button>
            <button onclick="javascript: MyActivityHandler();">View My Activity</button>
            <button onclick="javascript: LogOff();">Log Off</button>
        </div>

        <div id="QuestionList" class="contentPanel">
            <h2>Question List</h2>
            <!--<div>
                This should be a list of questions available for the logged-in user to answer.<br />
                If the logged-in user is a supervisor, it should be a list of questions they have posted.<br />
                <hr />
            </div>-->
            <div id="questionListDisplay">
                List should go here!
            </div>
            <button onclick="javascript: DashboardHandler();">Return to dashboard</button>
            <button onclick="javascript: LogOff();">Log Off</button>
        </div>

        <div id="AnswerList" class="contentPanel">
            <h2>Answer List</h2>
            <!--<div>
                Note: does not currently check if the answer is marked as reviewed.<br />
            </div>-->
            <div id="selectedQuestionToReview">Question should be displayed here.</div>
            <div id="answerListDisplay">
                List should go here!
            </div>
            <button onclick="javascript: QuestionListHandler();">Return to Question List</button>
            <button onclick="javascript: LogOff();">Log Off</button>
        </div>

        <div id="SubmitQuestion" class="contentPanel">
            <form id="postQuestionForm" onsubmit="submitQuestionHandler(); return false;">
                <h2>Submit Question</h2>
                <!-- <div>
                    Character limit: questionText: 1000<br />
                    This limit is enforced but the current character count and character limit are not displayed.
                </div> -->
                <div>
                    <textarea id="questionText" rows="10" cols="50" maxlength="1000" placeholder="Enter question..." required></textarea>
                </div>
                <div>
                    Days to live (enter 0 for no expiration): <input type="text" id="daysToLive" size="3" maxlength="3" placeholder="0" />
                </div>
                <div>
                    <!-- ADDED THIS SECTION TO THE PAGE-->
                    Response Type:
                    <select id="responseType">
                        <option value="freeResponse">Free Response</option>
                        <option value="multipleChoice">Multiple Choice</option>
                        <option value="numberRange">Number Range (1-10)</option>
                    </select>
                </div>
                <div id="multipleChoiceOptions" class="contentPanel" style="display: none;">
                    <h3>Enter options for Multiple Choice</h3>
                    <input type="text" id="option1" placeholder="Option 1">
                    <input type="text" id="option2" placeholder="Option 2">
                    <span id="extraOptions"></span>
                    <button type="button" onclick="addMoreOptions()">Add more options</button>
                </div>
                <div>
                    <!--<button type="submit">Save</button> -->
                    <button type="submit" class="button save-button">Save</button>

                </div>
                <hr />
            </form>
            <button onclick="javascript: DashboardHandler();">Cancel</button>
        </div>

        <div id="SubmitAnswer" class="contentPanel">
            <form id="postAnswerForm" onsubmit="submitAnswerHandler(); return false;">
                <h2>Submit Answer</h2>
                <div id="selectedQuestion">Question should be displayed here.</div>
                <!--<div>
                    Character limit: answerText: 1000<br />
                    This limit is enforced but the current character count and character limit are not displayed.
                </div> -->
                <div id="answerArea">
                    <!--This will be dynamically generated by the Handler based on the question type-->
                </div>
                <div>
                    <!-- <button type="submit">Save</button> -->
                    <button type="submit" class="button save-button">Save</button>

                </div>
                <hr />
            </form>
            <button onclick="javascript: QuestionListHandler();">Cancel</button>
        </div>

        <div id="unsolicitedFeedback" class="contentPanel">
            <form id="unsolicitedFeedbackForm" onsubmit="UnsolicitedFeedbackHandler(); return false;">
                <h2>Submit Unsolicited Feedback</h2>
                <!--<div>
                    Character limits: problemArea: 20, complaint: 50, proposedSolution: 1000<br />
                    These limits are enforced but the current character counts and character limits are not displayed.
                </div> -->
                <!-- Problem Area dropdown-->
                <div>
                    Problem Area: <select id="problemArea" required></select><!--Changed to select-->
                </div>

                <div>
                    Complaint: <input type="text" id="complaint" size="39" maxlength="50" required />
                </div>
                <div>
                    <textarea id="proposedSolution" rows="10" cols="50" maxlength="1000" placeholder="Enter proposed solution..." required></textarea>
                </div>
                <div>
                    <!--<button type="submit">Save</button>-->
                    <button type="submit" class="button save-button">Save</button>

                </div>
                <hr />
            </form>
            <button onclick="javascript: DashboardHandler();">Return to dashboard</button>

        </div>

        <!--NEWLY ADDED SECTION-->
        <!-- Placed the new configuration section here -->
        <!-- <div id="questionConfig" class="contentPanel hidden">
             <h2>Configure Question Types</h2>
             <div class="form-container">
                 <div class="radio-group">
                     <span>Response Type:</span><br />
                     <label><input type="radio" name="responseType" value="freeResponse"> Free Response</label><br />
                     <label><input type="radio" name="responseType" value="multipleChoice"> Multiple Choice</label><br />
                     <label><input type="radio" name="responseType" value="numberRange"> Number between 1-10</label>
                 </div>
                 <button type="button" onclick="saveQuestionConfig()" class="button">Save Configuration</button>
                 <button type="button" onclick="DashboardHandler();" class="button">Back to Dashboard</button>
             </div>
         </div> -->

        <div id="accountspanel" class="contentPanel">
            <form onsubmit="CreateAccount($('#newId').val(), $('#newUsername').val(), $('#newPassword').val(), $('#newDeparment').val(), $('#newIssupervisor').val()); return false;">
                <div class="left">Request Account</div>
                <hr />
                <div>
                    ID: <input type="text" id="newId" />
                </div>
                <div>
                    Username: <input type="text" id="newUsername" />
                </div>
                <div>
                    Password: <input type="password" id="newPassword" />
                </div>
                <div>
                    Department: <input type="text" id="newDeparment" />
                </div>
                <div>
                    Issupervisor: <input type="text" id="newIssupervisor" />
                </div>
                <hr />
                <div>
                    <button type="submit">Create Account</button>
                </div>
            </form>
        </div>

        <div id="editAccountPanel" class="contentPanel newAccountPanel">
            <div class="newAccountBox">
                <form onsubmit="EditAccount(); return false;">
                    <div class="left">Edit Account</div>
                    <div><a href="#" onclick="DeactivateAccount()" class="tinyLink">...or deactivate</a></div>
                    <hr />
                    <div>
                        ID: <input type="text" id="editLogonId" />
                    </div>
                    <div>
                        Pwd: <input type="password" id="editLogonPassword" />
                    </div>
                    <div>
                        First: <input type="text" id="editLogonFName" />
                    </div>
                    <div>
                        Last: <input type="text" id="editLogonLName" />
                    </div>
                    <div>
                        Email: <input type="text" id="editLogonEmail" />
                    </div>
                    <hr />
                    <div>
                        <!--<button type="submit">Save</button>-->
                        <button type="submit" class="button save-button">Save</button>

                    </div>
                </form>

            </div>
        </div>

        <div id="requestspanel" class="contentPanel">

        </div>
        <!-- Added the Unsolicited Feedback Review Section-->
        <div id="UnsolicitedFeedbackReview" class="contentPanel">
            <h2>Unsolicited Feedback Review</h2>
            <div id="unsolicitedFeedbackDisplay">
                <!-- Unsolicited feedback entries will be dynamically inserted here -->
            </div>
            <button onclick="javascript: DashboardHandler();">Return to Dashboard</button>
        </div>

        <!--Modified this section of html-->
        <div id="activityReportQuery" class="contentPanel">
            <h2 class="header-text">Generate Activity Report</h2>
            <div class="form-container">
                <div class="radio-group">
                    <span>Report Type:</span><br />
                    <label><input type="radio" name="reportType" value="answers" />Answers</label><br />
                    <label><input type="radio" name="reportType" value="unsolicitedFeedback" />Unsolicited Feedback</label><br />
                    <label><input type="radio" name="reportType" value="combined" />Combined</label>
                </div>

                <div class="radio-group">
                    <span>Departments to Include:</span><br />
                    <label><input type="radio" name="reportDepartment" value="all" />All</label><br />
                    <label><input type="radio" name="reportDepartment" value="mine" />My Department</label>
                </div>

                <input type="button" value="Generate Report" onclick="javascript: ActivityReportHandler();" class="button text-center" />
                <input type="button" value="Return to dashboard" onclick="javascript: DashboardHandler();" class="button text-center" />
            </div>
        </div>


        <div id="ActivityList" class="contentPanel">
            <h2>Activity Report</h2>
            <div id="selectedActivityList">
                List heading should go here
            </div>
            <div id="displayedActivityList">
                List of most active users should go here
            </div>
            <button onclick="showPanel('activityReportQuery')">Back to Activity List Options</button>
            <button onclick="DashboardHandler()">Back to Dashboard</button>
        </div>

        <div id="MyActivity" class="contentPanel">
            <h2>Activity Report</h2>
            <div id="MyActivityList">
                List heading should go here
            </div>
            <div id="MostActiveLists">
                List of most active users should go here
            </div>
            <button onclick="DashboardHandler()">Back to Dashboard</button>
        </div>

    </div>

    <!--This div is only to display the "display session variables" button on each page
        and should be deleted before project submission
    <div><button onclick="javascript: alertSessionVars();">Alert Session Variables</button></div>
        -->
    <!--YOUR OWN JAVASCRIPT CAN GO RIGHT HERE-->
    <script type="text/javascript">

        function addMoreOptions() {
            var i = 3;
            while (i > 0) {
                var elem = document.getElementById('option' + i);
                if (JSON.stringify(elem) === JSON.stringify(null)) {
                    var newElem = document.createElement('input');
                    newElem.type = 'text';
                    newElem.id = 'option' + i;
                    newElem.placeholder = 'Option ' + i;
                    document.getElementById('extraOptions').appendChild(newElem);
                    var newBR = document.createElement('br');
                    document.getElementById('extraOptions').appendChild(newBR);
                    break;
                } else {
                    i++;
                }
            }
        }

        //Calls requestaccount and creates an account
        function CreateAccount(id, uid, pass, department, issupervisor) {
            var webMethod = "ProjectServices.asmx/RequestAccount";
            var parameters = "{\"pid\":\"" + encodeURI(id) + "\",\"userid\":\"" + encodeURI(uid) + "\",\"pass\":\"" + encodeURI(pass) + "\",\"department\":\"" + encodeURI(department) + "\",\"issupervisor\":\"" + encodeURI(issupervisor) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    showPanel('accountspanel');
                    alert("Account created");
                },
                error: function (e) {
                    alert("Account Creation Failed");
                }
            });
        }

        //this function executes once jQuery has successfully loaded and is
        //ready for business.  Usually, if we're wiring up event handlers via jQuery
        //then this is where they go.
        jQuery(function () {
            //when the app loads, check to see if the user is logged in.  If so, show their dashboard.  If not, show the logon panel to start with!
            var webMethod = "ProjectServices.asmx/IsSupervisor";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === -1) {
                        showPanel('login-container');
                    } else {
                        if (msg.d === 1) {
                            showPanel('SupervisorHome');
                        } else {
                            showPanel('EmployeeHome');
                        }
                    }
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        });

        //we're using a stacked card approach for our main viewing area
        //this array holds the ids of our cards and the method
        //allows us to easly switch the interface from one to the other
        var contentPanels = ['login-container', 'resetPasswordPanel', 'SupervisorHome', 'EmployeeHome', 'QuestionList', 'AnswerList', 'SubmitAnswer', 'unsolicitedFeedback', 'SubmitQuestion', 'UnsolicitedFeedbackReview', 'accountspanel', 'requestspanel', 'editAccountPanel', 'activityReportQuery', 'ActivityList', 'MyActivity'];
        //this function toggles which panel is showing, and also clears data from all panels
        // Toggles which panel is showing, and also clears data from all panels
        function showPanel(panelId) {
            clearData();
            contentPanels.forEach(function (panel) {
                var element = document.getElementById(panel);
                if (panelId == panel) {
                    element.style.display = 'flex'; // Show the requested panel
                } else {
                    element.style.display = 'none'; // Hide other panels
                }
            });
        }


        //this function clears data from all panels
        function clearData() {
            $('#questionText').val("");
            $('#problemArea').val("");
            $('#complaint').val("");
            $('#proposedSolution').val("");
            $('#answerText').val("");
            $('#daysToLive').val("");
            $('#questNum').val("");
            $("#accountsBox").empty();
            $("#requestsBox").empty();
            //clearNewAccount();
            clearLogon();
            //clearEditAccount();
            // more will be added as more panels are added
        }

        function DashboardHandler() {
            //return the user to their dashboard
            var webMethod = "ProjectServices.asmx/IsSupervisor";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === -1) {
                        showPanel('login-container');
                    } else {
                        if (msg.d === 1) {
                            showPanel('SupervisorHome');
                        } else {
                            showPanel('EmployeeHome');
                        }
                    }
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        // Login handler function
        function LogOn(userId, pass) {
            var webMethod = "ProjectServices.asmx/LogOn";
            var parameters = "{\"userId\":\"" + encodeURI(userId) + "\",\"pass\":\"" + encodeURI(pass) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === 1) {
                        alert("logon successful");
                        showPanel('SupervisorHome');
                    } else if (msg.d === 0) {
                        alert("logon successful");
                        showPanel('EmployeeHome');
                    } else {
                        alert('Login failed: Incorrect username or password.');
                    }
                    LoadAccounts();
                },
                error: function (e) {
                    alert("There was an issue with the login request.");
                }
            });
        }

        function LogOff() {
            var webMethod = "ProjectServices.asmx/LogOff";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {
                        clearData();
                        alert("All sessions have been ended");
                        showPanel('login-container');
                        HideMenu();
                    }
                    else {
                    }
                },
                error: function (e) {
                    alert("There was an issue with the logoff request.");
                }
            });
        }

        var accountsArray;
        var admin = false;

        //resets the logon inputs
        function clearLogon() {
            $('#userId').val("");
            $('#pass').val("");
        }

        var accountWindowShowing = false;
        //and here's a function that adjusts the menu options if you're an admin or a user
        //and if you're looking at accounts or requests
        function ShowMenu() {

            $("#menu").css("visibility", "visible");
            if (admin) {
                if (accountWindowShowing) {
                    $("#adminLink").text("requests");
                }
                else {
                    $("#adminLink").text("accounts");
                }
            }
        }

        //just hides the menu
        function HideMenu() {

            $("#menu").css("visibility", "hidden");
            $("#adminLink").text("");
        }


        //a simple ajax call that passes the id to be approved
        function approveAccount(id) {
            var webMethod = "ProjectServices.asmx/ActivateAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    showPanel('requestsPanel');
                    LoadRequests();
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //virtually identical with approve
        function rejectAccount(id) {
            var webMethod = "ProjectServices.asmx/RejectAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    showPanel('requestsPanel');
                    LoadRequests();
                },
                error: function (e) {
                    alert("rejectAccount error");
                }
            });
        }


        function LoadAccounts() {
            var webMethod = "ProjectServices.asmx/GetAccounts";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {

                        accountsArray = msg.d;

                        $("#accountsBox").empty();
                        admin = false;
                        for (var i = 0; i < accountsArray.length; i++) {
                            var acct;
                            if (accountsArray[i].userId != null) {
                                acct = "<div class='accountRow' id='acct" + accountsArray[i].id + "'>" +
                                    "<a class='nameTag' href='mailto:" + accountsArray[i].email + "'>" +
                                    accountsArray[i].firstName + " " + accountsArray[i].lastName +
                                    "</a> <a href='#' onclick='LoadAccount(" + accountsArray[i].id + ")' class='optionsTag'>edit</a></div><hr>"
                                admin = true;
                            }
                            else {
                                acct = "<div class='accountRow' id='acct" + accountsArray[i].id + "'>" +
                                    "<a class='nameTag' href='mailto:" + accountsArray[i].email + "'>" +
                                    accountsArray[i].firstName + " " + accountsArray[i].lastName +
                                    "</a></div><hr>"
                            }
                            $("#accountsBox").append(
                                acct
                            );
                        }
                    }
                    accountWindowShowing = true;
                    ShowMenu();
                },
                error: function (e) {
                    alert("loadaccounts error");
                }
            });
        }

        var currentAccount;
        //load up an account for editing
        function LoadAccount(id) {
            showPanel('editAccountPanel');
            currentAccount = null;
            //find the account with a matching id in our array
            for (var i = 0; i < accountsArray.length; i++) {
                if (accountsArray[i].id == id) {
                    currentAccount = accountsArray[i]
                }
            }
            //set up our inputs
            if (currentAccount != null) {
                $('#editLogonId').val(currentAccount.userId);
                $('#editpass').val(currentAccount.pass);
                $('#editdepartment').val(currentAccount.department);
                $('#editsupervisor').val(currentAccount.supervisor);
                $('#editissupervisor').val(currentAccount.issupervisor);
            }
        }

        function submitQuestionHandler() {
            var webMethod = "ProjectServices.asmx/SubmitQuestion";
            var parameters = "{}";
            var parameters = "{\"questionText\":\"" + encodeURI($('#questionText').val()) + "\",\"daysToLive\":\"" + encodeURI($('#daysToLive').val()) + "\",\"questionType\":\"" + encodeURI($('#responseType').val()) + "\"}";
            var responseType = $('#responseType').val();
            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var responseFromServer = msg.d;
                    if (responseFromServer > 0) {
                        if (responseType == 'freeResponse' || responseType == 'numberRange') {
                            alert("Question submitted successfully");
                        } else {
                            var webMethod = "ProjectServices.asmx/SubmitMultipleChoice";
                            var parameters = "{}";
                            var optionsArray = [];
                            i = 1;
                            optionsArray.push(responseFromServer.toString());
                            while (i > 0) {
                                var elem = document.getElementById('option' + i);
                                if (i > 10) {
                                    alert("You have reached the maximum number of options");
                                    console.log("You have reached the maximum number of options");
                                    break;
                                }
                                if (JSON.stringify(elem) !== JSON.stringify(null)) {
                                    optionsArray.push(encodeURI(elem.value));
                                    console.log("Pushed " + elem.value + " to optionsArray");
                                    i++;
                                } else {
                                    console.log("elem is null");
                                    break;
                                }
                            }
                            var parameters = JSON.stringify({ array: optionsArray });
                            console.log(parameters);
                            $.ajax({
                                type: "POST",
                                url: webMethod,
                                data: parameters,
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (msg) {
                                    console.log(msg.d);
                                    var responseFromServer = msg.d;
                                    if (responseFromServer > 0) {
                                        alert("Question submitted successfully");
                                    }
                                    else {
                                        alert("Question submission failed");
                                    }
                                },
                                error: function (e) {
                                    alert("this code will only execute if javascript is unable to access the webservice");
                                },
                                complete: function () {
                                    //DashboardHandler();
                                }
                            });
                        }

                    }
                    else {
                        alert("Question submission failed");
                    }
                },
                error: function (e) {
                    alert("this code will only execute if javascript is unable to access the webservice");
                },
                complete: function () {
                    DashboardHandler();
                }
            });
        }

        // Modified UnsolicitedFeedbackHandler to use problemArea dropdown value
        function UnsolicitedFeedbackHandler() {
            var problemArea = $('#problemArea').val(); // Get selected problem area
            var complaint = $('#complaint').val();
            var proposedSolution = $('#proposedSolution').val();
            var webMethod = "ProjectServices.asmx/UnsolicitedFeedback";
            var parameters = "{}";
            var parameters = "{\"problemArea\":\"" + encodeURI($('#problemArea').val()) + "\",\"complaint\":\"" + encodeURI($('#complaint').val()) + "\",\"proposedSolution\":\"" + encodeURI($('#proposedSolution').val()) + "\"}";

            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var responseFromServer = msg.d;
                    if (responseFromServer > 0) {
                        alert("Feedback submitted successfully");
                        showPanel('EmployeeHome');
                    }
                    else {
                        alert("Feedback submission failed");
                    }
                },
                error: function (e) {
                    alert("this code will only execute if javascript is unable to access the webservice");
                }
            });
        }

        // Added this function for Dropdown menu
        // Populate Problem Areas Dropdown (New Function)
        function populateProblemAreasDropdown() {
            var webMethod = "ProjectServices.asmx/GetProblemAreas";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    var dropdown = $('#problemArea');
                    dropdown.empty(); // Clear existing options
                    dropdown.append($('<option></option>').attr('value', '').text('Select a problem area'));
                    $.each(response.d, function (key, value) {
                        dropdown.append($('<option></option>').attr('value', value).text(value));
                    });
                },
                error: function (e) {
                    console.log("Error fetching problem areas: ", e);
                }
            });
        }

        // Call populateProblemAreasDropdown when the page loads
        $(document).ready(function () {
            populateProblemAreasDropdown();
        });

        // Adds event listeners to forms
        $('#postQuestionForm').submit(function (e) {
            e.preventDefault(); // Prevent the default form submission
            //submitQuestionHandler(); // Was double-submitting as it called here and in the onsubmit attribute of the div
        });

        $('#activityReportForm').submit(function (e) {
            e.preventDefault(); // Prevent the default form submission
            ActivityReportHandler();
        });

        $('#unsolicitedFeedbackForm').submit(function (e) {
            e.preventDefault(); // Prevent the default form submission
            unsolicitedFeedbackHandler();
        });

        $('#responseType').on('change', function () {
            var element = document.getElementById('multipleChoiceOptions');
            var selectedValue = $('#responseType').val();
            console.log(selectedValue);
            if (selectedValue === 'multipleChoice') {
                element.style.display = 'flex';
            } else {
                element.style.display = 'none';
            }
        });


        //this is to display questions available to be answered or reviewed
        function QuestionListHandler() {
            var webMethod = "ProjectServices.asmx/IsSupervisor";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    issupervisor = msg.d;
                    var webMethod2 = "ProjectServices.asmx/GetQuestions";
                    $.ajax({
                        type: "POST",
                        url: webMethod2,
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (msg) {
                            console.log(msg.d.length);
                            if (msg.d.length > 0) {
                                $("#questionListDisplay").empty();
                                for (var i = 0; i < msg.d.length; i++) {
                                    if (issupervisor == 1) {
                                        if (msg.d[i].isExpired == true) {
                                            closeq = "";
                                        }
                                        else {
                                            closeq = "<span class='optionsTag'><a href='#' onclick='CloseQuestion(" + msg.d[i].id + ")'>Close Question</a></span>";
                                        }
                                        if (msg.d[i].numAnswers == 0) {
                                            question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>"
                                                + "<span class='questionText'>" + msg.d[i].question + "</span><br />"
                                                + "<span class='expiryDate'>Expiry Date: " + msg.d[i].expiryDate.split(' ')[0] + " </span> <br />"
                                                + "<span class='notOptionsTag'> No responses have been received</span> <br />" + closeq + " </div> <hr>";

                                        }
                                        else if (msg.d[i].unreviewed == 0) {
                                            question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>"
                                                + "<span class='questionText'>" + msg.d[i].question + "</span><br />"
                                                + "<span class='expiryDate'>Expiry Date: " + msg.d[i].expiryDate.split(' ')[0] + " </span> <br />"
                                                + "<span class='notOptionsTag'>No unreviewed responses</span> <br />"
                                                + "<span class='optionsTag'><a href='#' onclick='AnswerListHandler(" + msg.d[i].id
                                                + ",1)'> see all responses (" + msg.d[i].numAnswers + ")</a></span> <br />" + closeq + "</div> <hr>";

                                        }
                                        else {
                                            question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>"
                                                + "<span class='questionText'>" + msg.d[i].question + "</span><br />"
                                                + "<span class='expiryDate'>Expiry Date: " + msg.d[i].expiryDate.split(' ')[0] + " </span> <br />"
                                                + "<span class='optionsTag'><a href='#' onclick='AnswerListHandler(" + msg.d[i].id
                                                + ",0)'> review responses (" + msg.d[i].unreviewed + ")</a></span> <br />"
                                                + "<span class='optionsTag'><a href='#' onclick='AnswerListHandler(" + msg.d[i].id
                                                + ",1)'> see all responses (" + msg.d[i].numAnswers + ")</a></span> <br />" + closeq + "</div> <hr>";
                                        }
                                    }
                                    else {
                                        if (i == 3) {
                                            try {
                                                question = "<div class='questionRow' id='questMore'><span class='questionText'> You have " + (msg.d.length - i) +
                                                    " more questions available.  Please respond to the above questions first.</span></div> <hr>";
                                                $("#questionListDisplay").append(question);
                                            }
                                            finally {
                                                return;
                                            }
                                        }
                                        question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>" + "<span class='questionText'>" + msg.d[i].question
                                            + "<br /> <span class='expiryDate'>Expiry Date: " + msg.d[i].expiryDate.split(' ')[0] + "</span>"
                                            + "</span><br /> <span class='optionsTag'><a href='#' onclick='AnswerHandler(" + msg.d[i].id + ")'>respond</a> </div> <hr>";
                                    }
                                    $("#questionListDisplay").append(question);
                                }
                            }
                            else {
                                $("#questionListDisplay").empty();
                                question = "<div class='questionRow' id='questR0'>No questions available</div> <hr>";
                                $("#questionListDisplay").append(question);
                            }
                        },
                        error: function (e) {
                            alert("boo...2");
                        },
                        complete: function () {
                            showPanel("QuestionList");
                        }
                    });
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //this is to close a question
        function CloseQuestion(questionID) {
            var webMethod = "ProjectServices.asmx/CloseQuestion";
            var parameters = "{\"questionID\":\"" + questionID + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d) {
                        alert("Question closed.")
                    }
                    else {
                        alert("Question closure failed.")
                    }
                },
                error: function (e) {
                    alert("boo...");
                },
                complete: function () {
                    QuestionListHandler();
                }
            });
        }


        //this is to display question and provide textbox for answer
        function AnswerHandler(questionID) {
            var webMethod = "ProjectServices.asmx/GetQuestionToAnswer";
            var parameters = "{\"questionID\":\"" + questionID + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        $("#selectedQuestion").empty();
                        for (var i = 0; i < msg.d.length; i++) {
                            question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>" +
                                "<span class='questionText'>" + msg.d[i].question + "</span> <span id='questNum' style='display:none;'>" + msg.d[i].id + "</span><hr>";
                            $("#selectedQuestion").append(question);
                            if (msg.d[i].questionType == 'multipleChoice') {
                                var webMethod = "ProjectServices.asmx/GetMultipleChoiceOptions";
                                var parameters = "{\"questionID\":\"" + questionID + "\"}";
                                $.ajax({
                                    type: "POST",
                                    url: webMethod,
                                    data: parameters,
                                    contentType: "application/json; charset=utf-8",
                                    dataType: "json",
                                    success: function (msg) {
                                        if (msg.d.length > 0) {
                                            $("#answerArea").empty();
                                            options = "<select id='answerText'>";
                                            for (var i = 0; i < msg.d.length; i++) {
                                                options += "<option value=\"" + msg.d[i] + "\">" + msg.d[i] + "</option>";
                                            }
                                            options += "</select>";
                                            $("#answerArea").append(options);
                                        }
                                    },
                                    error: function (e) {
                                        alert("boo...");
                                    },
                                    complete: function () {
                                    }
                                });
                            }
                            else if (msg.d[i].questionType == 'numberRange') {
                                $("#answerArea").empty();
                                answer = "<input type='number' id='answerText' min='1' max='10' required>";
                                $("#answerArea").append(answer);
                            }
                            else {
                                $("#answerArea").empty();
                                answer = "<textarea id='answerText' rows='10' cols='50' maxlength='1000' placeholder='Enter answer...' required></textarea>";
                                $("#answerArea").append(answer);
                            }
                        }
                    }
                },
                error: function (e) {
                    alert("boo...");
                },
                complete: function () {
                    showPanel("SubmitAnswer");
                }
            });
        }

        function submitAnswerHandler() {
            var webMethod = "ProjectServices.asmx/SubmitAnswer";
            var parameters = "{}";
            var parameters = "{\"answerText\":\"" + encodeURI($('#answerText').val()) + "\",\"questionID\":\"" + encodeURI($('#questNum').text()) + "\"}";
            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    var responseFromServer = msg.d;
                    if (responseFromServer > 0) {
                        alert("Answer submitted successfully");
                    }
                    else {
                        alert("Answer submission failed");
                    }
                },
                error: function (e) {
                    alert("this code will only execute if javascript is unable to access the webservice");
                },
                complete: function () {
                    QuestionListHandler();
                }
            });
        }

        //this is to display answers available to be reviewed
        function AnswerListHandler(questionID, seeall) {
            //get the question to display
            var webMethod = "ProjectServices.asmx/GetQuestionToAnswer";
            var parameters = "{\"questionID\":\"" + questionID + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        $("#selectedQuestionToReview").empty();
                        for (var i = 0; i < msg.d.length; i++) {
                            question = "<div class='questionRow' id='questR" + msg.d[i].id + "'>" +
                                "<span class='questionText'>" + msg.d[i].question + "</span> <span id='questNum' style='display:none;'>" + msg.d[i].id + "</span><hr>";
                            $("#selectedQuestionToReview").append(question);
                        }
                    }
                    else {
                        alert("No question found");
                    }
                },
                error: function (e) {
                    alert("boo...");
                },
                complete: function () {
                    //get the answers to display
                    var webMethod = "ProjectServices.asmx/GetAnswers";
                    var parameters = "{\"questionID\":\"" + questionID + "\",\"seeall\":\"" + seeall + "\"}";

                    $.ajax({
                        type: "POST",
                        url: webMethod,
                        data: parameters,
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (msg) {
                            if (msg.d.length > 0) {
                                $("#answerListDisplay").empty();
                                for (var i = 0; i < msg.d.length; i++) {
                                    if (msg.d[i].reviewed == 0) {
                                        answer = "<div class='answerRow' id='answerR" + msg.d[i].id + "'>" + "<span class='answerText'>" + msg.d[i].answer + "</span><br />"
                                            + "<span class='optionsTag'><a href='#' onclick='MarkAnswer(" + questionID + "," + msg.d[i].id + ",0)'>mark as reviewed</a> </span><br /> "
                                            + "<span class='optionsTag'><a href='#' onclick='MarkAnswer(" + questionID + "," + msg.d[i].id + ",1)'>discard answer</a> </span> </div> <hr>";
                                        $("#answerListDisplay").append(answer);
                                    }
                                    else {
                                        answer = "<div class='answerRow' id='answerR" + msg.d[i].id + "'>" + "<span class='answerText'>" + msg.d[i].answer + "</span><br />"
                                            + "<span class='notOptionsTag'>Reviewed </span><br /> "
                                            + "<span class='optionsTag'><a href='#' onclick='MarkAnswer(" + questionID + "," + msg.d[i].id + ",1)'>discard answer</a> </span> </div> <hr>";
                                        $("#answerListDisplay").append(answer);
                                    }
                                }
                            }
                            else {
                                $("answerListDisplay").empty();
                                $("answerListDisplay").append("<div class='answerRow' id='answerR0'>No answers found</div><hr>)");
                            }
                        },
                        error: function (e) {
                            alert("boo...hiss");
                        },
                        complete: function () {
                            showPanel("AnswerList");
                        }
                    });

                }
            });
        }

        //this is to mark the answer as reviewed and possibly discarded
        function MarkAnswer(questionID, answerID, discarded) {
            var webMethod = "ProjectServices.asmx/AnswerReviewed";
            var parameters = "{\"questionID\":\"" + questionID + "\",\"answerID\":\"" + answerID + "\",\"discarded\":\"" + discarded + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (discarded == 1) {
                        alert("Answer marked as discarded");
                    }
                    else {
                        alert("Answer marked as reviewed and archived");
                    }
                    if (msg.d.length > 0) {
                        $("#answerListDisplay").empty();
                        for (var i = 0; i < msg.d.length; i++) {
                            answer = "<div class='answerRow' id='answerR" + msg.d[i].id + "'>" + "<span class='answerText'>" + msg.d[i].answer + "</span><br />"
                                + "<span class='optionsTag'><a href='#' onclick='MarkAnswer(" + questionID + "," + msg.d[i].id + ",0)'>mark as reviewed</a> </span><br /> "
                                + "<span class='optionsTag'><a href='#' onclick='MarkAnswer(" + questionID + "," + msg.d[i].id + ",1)'>discard answer</a> </span> </div> <hr>";
                            $("#answerListDisplay").append(answer);
                        }
                    }
                    else {
                        $("#answerListDisplay").empty();
                        answer = "<div class='answerRow' id='answerR0'>No answers found</div><hr>"
                        $("#answerListDisplay").append(answer);
                    }
                },
                error: function (e) {
                    alert("this code will only execute if javascript is unable to access the webservice");
                },
                complete: function () {
                }
            });
        }

        // Reset Password Handler
        function resetPasswordHandler() {
            var userId = $('#resetUserId').val();
            var oldPass = $('#oldPass').val();
            var newPass = $('#newPass').val();

            // Construct the web method endpoint
            var webMethod = "ProjectServices.asmx/PasswordReset";
            // Prepare the data to be sent in the request
            var parameters = "{\"userid\":\"" + encodeURI(userId) + "\",\"pass\":\"" + encodeURI(oldPass) + "\",\"newpass\":\"" + encodeURI(newPass) + "\"}";

            // Makes the AJAX call
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                data: parameters,
                dataType: "json",
                success: function (response) {
                    if (response.d) {
                        alert("Password successfully reset. Please log in with your new password.");
                        // Optionally, hide the reset password panel and show the login panel again
                        showPanel('login-container');
                    } else {
                        alert("Failed to reset password. Please check your details and try again.");
                    }
                },
                error: function () {
                    alert("Error processing your request. Please try again later.");
                }
            });
        }

        // Attached the reset password form submit event handler
        $('#resetPasswordForm').submit(function (e) {
            e.preventDefault(); // Prevent the default form submission
            resetPasswordHandler();
        });

        // Added the loadUnsolicitedFeedbackReview function
        function loadUnsolicitedFeedbackReview() {
            var webMethod = "ProjectServices.asmx/GetUnsolicitedFeedback";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    var feedbacks = response.d;
                    var displayArea = $('#unsolicitedFeedbackDisplay');
                    displayArea.empty(); // Clear previous entries

                    if (feedbacks.length > 0) {
                        feedbacks.forEach(function (feedback) {
                            var feedbackEntry = $("<div class='feedbackEntry'></div>");
                            feedbackEntry.html(
                                "<p><strong>Problem Area:</strong> " + feedback.problemArea + "</p>" +
                                "<p><strong>Complaint:</strong> " + feedback.complaint + "</p>" +
                                "<p><strong>Proposed Solution:</strong> " + feedback.suggestion + "</p>" +
                                "<a href='#' onclick='MarkFeedback(" + feedback.id + ",0)'>Mark as Reviewed</a> | " +
                                "<a href='#' onclick='MarkFeedback(" + feedback.id + ",1)'>Discard</a>"

                            );
                            displayArea.append(feedbackEntry);
                        });
                    } else {
                        displayArea.html("<p>No unsolicited feedback available for review.</p>");
                    }
                },
                error: function (e) {
                    console.error("Error fetching unsolicited feedback: ", e);
                    alert('Error loading unsolicited feedback. Please try again.');
                },
                complete: function () {
                    showPanel('UnsolicitedFeedbackReview');
                }
            });
        }

        //this is to mark the feedback as reviewed and possibly discarded
        function MarkFeedback(feedbackID, discarded) {
            var webMethod = "ProjectServices.asmx/UnsolicitedReviewed";
            var parameters = "{\"feedbackID\":\"" + feedbackID + "\",\"discarded\":\"" + discarded + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    var feedbacks = response.d;
                    var displayArea = $('#unsolicitedFeedbackDisplay');
                    displayArea.empty(); // Clear previous entries

                    if (feedbacks.length > 0) {
                        feedbacks.forEach(function (feedback) {
                            var feedbackEntry = $("<div class='feedbackEntry'></div>");
                            feedbackEntry.html(
                                "<p><strong>Problem Area:</strong> " + feedback.problemArea + "</p>" +
                                "<p><strong>Complaint:</strong> " + feedback.complaint + "</p>" +
                                "<p><strong>Proposed Solution:</strong> " + feedback.suggestion + "</p>" +
                                "<a href='#' onclick='MarkFeedback(" + feedback.id + ",0)'>Mark as Reviewed</a> | " +
                                "<a href='#' onclick='MarkFeedback(" + feedback.id + ",1)'>Discard</a>"

                            );
                            displayArea.append(feedbackEntry);
                        });
                    } else {
                        displayArea.html("<p>No unsolicited feedback available for review.</p>");
                    }
                },
                error: function (e) {
                    console.error("Error fetching unsolicited feedback: ", e);
                    alert('Error loading unsolicited feedback. Please try again.');
                },
                complete: function () {
                    showPanel('UnsolicitedFeedbackReview');
                }
            });
        }


        function ActivityReportHandler() {
            var ele = document.getElementsByName('reportType');
            for (i = 0; i < ele.length; i++) {
                if (ele[i].checked) {
                    reportType = ele[i].value;
                }
            }
            ele = document.getElementsByName('reportDepartment');
            for (i = 0; i < ele.length; i++) {
                if (ele[i].checked) {
                    department = ele[i].value;
                }
            }
            var webMethod = "ProjectServices.asmx/GetMostActiveUsers";
            var parameters = "{\"reportType\":\"" + encodeURI(reportType) + "\",\"department\":\"" + encodeURI(department) + "\"}";
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        $("#selectedActivityList").empty();
                        if (department == "mine")
                            dept = "your department";
                        else
                            dept = "all departments";
                        if (reportType == "answers") {
                            reptype = "Questions Answered";
                            activityType = "Answers";
                        }
                        else if (reportType == "unsolicitedFeedback") {
                            reptype = "Unsolicited Feedback Submitted";
                            activityType = "Unsolicited Feedback";
                        }
                        else {
                            reptype = "All Activity";
                            activityType = "Answers</th><th>Unsolicited Feedback</th><th>Combined";
                        }
                        selectedlist = "<div id='activityListDescription' class='listDescription'>Most active users for " + reptype + " in " + dept + ".</div><br />";
                        $("#selectedActivityList").append(selectedlist);

                        $("#displayedActivityList").empty();
                        listcontent = "<table id='activityListTable' class='listTable'><tr id='activityListHead' class='listHead'><th>Rank</th><th>User ID</th><th>" + activityType + "</th></tr>";

                        for (var i = 0; i < msg.d.length; i++) {
                            if (reportType == "answers") {
                                numberstoreport = msg.d[i].numAnswers;
                            }
                            else if (reportType == "unsolicitedFeedback") {
                                numberstoreport = msg.d[i].numUSF;
                            }
                            else {
                                numberstoreport = msg.d[i].numAnswers + "</td><td>" + msg.d[i].numUSF + "</td><td>" + msg.d[i].numTotal;
                            }
                            listcontent += "<tr id='listR" + (i + 1) + "' class='listRow'><td>" + (i + 1) + "</td><td>" + msg.d[i].userId + "</td><td>" + numberstoreport + "</td></tr>";
                        }
                        listcontent += "</table>";
                        $("#displayedActivityList").append(listcontent);
                    }
                    else {
                        alert("No activity found");
                    }
                },
                error: function (e) {
                    alert("boo...");
                },
                complete: function () {
                    showPanel("ActivityList");
                }
            });
        }


        function MyActivityHandler() {
            var webMethod = "ProjectServices.asmx/GetMyActivity";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    myID = msg.d.id;
                    $("#MyActivityList").empty();
                    myActivity = "<div id='activityListDescription' class='listDescription'>Your activity:</div><br /><table id='activityListTable' class='listTable'>"
                        + "<tr id='activityListHead' class='listHead'><th>Answers</th><th>Unsolicited Feedback</th><th>Combined</th></tr>"
                        + "<tr id = 'listR0' class='listRow'><td>" + msg.d.numAnswers + "</td><td>" + msg.d.numUSF + "</td><td>" + msg.d.numTotal + "</td></tr></table><br />";
                    $("#MyActivityList").append(myActivity);
                },
                error: function (e) {
                    alert("boo...");
                },
                complete: function () {
                    reportType = "combined";
                    department = "mine";
                    var webMethod = "ProjectServices.asmx/GetMostActiveUsers";
                    var parameters = "{\"reportType\":\"" + encodeURI(reportType) + "\",\"department\":\"" + encodeURI(department) + "\"}";
                    $.ajax({
                        type: "POST",
                        url: webMethod,
                        data: parameters,
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (msg) {
                            if (msg.d.length > 0) {
                                $("#MostActiveLists").empty();
                                myDeptActivity = "<div id='activityListDescription' class='listDescription'>Most active users in my department.</div><br />"
                                    + "<table id='activityListTable' class='listTable'><tr id='activityListHead' class='listHead'><th>Rank</th><th>User ID</th><th>Answers</th><th>Unsolicited Feedback</th><th>Combined</th></tr>";
                                for (var i = 0; i < msg.d.length; i++) {
                                    numberstoreport = msg.d[i].numAnswers + "</td><td>" + msg.d[i].numUSF + "</td><td>" + msg.d[i].numTotal;
                                    if (myID == msg.d[i].id) {
                                        userIdToDisplay = "You";
                                    }
                                    else {
                                        userIdToDisplay = "Someone Else";
                                    }
                                    myDeptActivity += "<tr id='listR" + (i + 1) + "' class='listRow'><td>" + (i + 1) + "</td><td>" + userIdToDisplay + "</td><td>" + numberstoreport + "</td></tr>";
                                }
                                myDeptActivity += "</table><br />";
                                $("#MostActiveLists").append(myDeptActivity);
                            }
                            else {
                                alert("No activity found");
                            }
                        },
                        error: function (e) {
                            alert("boo...");
                        },
                        complete: function () {
                            reportType = "combined";
                            department = "all";
                            var webMethod = "ProjectServices.asmx/GetMostActiveUsers";
                            var parameters = "{\"reportType\":\"" + encodeURI(reportType) + "\",\"department\":\"" + encodeURI(department) + "\"}";
                            $.ajax({
                                type: "POST",
                                url: webMethod,
                                data: parameters,
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (msg) {
                                    if (msg.d.length > 0) {
                                        myDeptActivity = "<div id='activityListDescription' class='listDescription'>Most active users in all departments.</div><br />"
                                            + "<table id='activityListTable' class='listTable'><tr id='activityListHead' class='listHead'><th>Rank</th><th>User ID</th><th>Answers</th><th>Unsolicited Feedback</th><th>Combined</th></tr>";
                                        for (var i = 0; i < msg.d.length; i++) {
                                            numberstoreport = msg.d[i].numAnswers + "</td><td>" + msg.d[i].numUSF + "</td><td>" + msg.d[i].numTotal;
                                            if (myID == msg.d[i].id) {
                                                userIdToDisplay = "You";
                                            }
                                            else {
                                                userIdToDisplay = "Someone Else";
                                            }
                                            myDeptActivity += "<tr id='listR" + (i + 1) + "' class='listRow'><td>" + (i + 1) + "</td><td>" + userIdToDisplay + "</td><td>" + numberstoreport + "</td></tr>";
                                        }
                                        myDeptActivity += "</table>";
                                        $("#MostActiveLists").append(myDeptActivity);
                                    }
                                    else {
                                        alert("No activity found");
                                    }
                                },
                                error: function (e) {
                                    alert("boo...");
                                },
                                complete: function () {
                                    showPanel("MyActivity");
                                }
                            });
                        }
                    });
                }
            });
        }



        // NOTE THIS IS ONLY HERE BECAUSE I AM A LAZY DEVELOPER AND GOT TIRED OF TYPING IN CREDENTIALS
        // THIS WILL NEED TO BE DELETED BEFORE THE PROJECT IS SUBMITTED
        function lazyloginHandler(role) {
            var webMethod = "ProjectServices.asmx/Login";
            var parameters = "{\"role\":\"" + role + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d === 1) {
                        showPanel('SupervisorHome')
                    } else if (msg.d === 0) {
                        showPanel('EmployeeHome')
                    } else {
                        alert('Login failed: Incorrect username or password.');
                    }
                },
                error: function (e) {
                    alert("boo...hiss");
                }
            });
        }

        //THIS SHOULD ALSO BE DELETED BEFORE PROJECT IS SUBMITTED
        //This just alerts what the current sesion variables are
        //This is used to diagnose potential issues with the session variables
        function alertSessionVars() {
            var webMethod = "ProjectServices.asmx/GetSessionVars";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert("id: " + msg.d.id + " issupervisor: " + msg.d.issupervisor + " supervisor: " + msg.d.supervisor)
                },
                error: function (e) {
                    alert("boo...hiss");
                }
            });
        }


        //ajax to edit account
        function EditAccount() {
            var webMethod = "ProjectServices.asmx/UpdateAccount";
            var parameters = "{\"id\":\"" + encodeURI(currentAccount.id) + "\",\"uid\":\"" + encodeURI($('#editLogonId').val()) + "\",\"pass\":\"" + encodeURI($('#editLogonPassword').val()) + "\",\"department\":\"" + encodeURI($('#editDepartment').val()) + "\",\"issupervisor\":\"" + encodeURI($('#editIssupervisor').val()) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    showPanel('accountsPanel');
                    LoadAccounts();
                },
                error: function (e) {
                    alert("Your profile update failed");
                }
            });
        }

        function GoBack() {
            jQuery(function () {
                //when the app loads, check to see if the user is logged in.  If so, show their dashboard.  If not, show the logon panel to start with!
                var webMethod = "ProjectServices.asmx/IsSupervisor";
                $.ajax({
                    type: "POST",
                    url: webMethod,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        if (msg.d === 1) {
                            showPanel('SupervisorHome');
                        } else {
                            showPanel('EmployeeHome');
                        }
                    },
                    error: function (e) {
                        alert("boo...");
                    }
                });
            });
        }

    </script>
</body>
</html>
















